const functions = {
  copyChar: "copy_char",
  checkFlag: "check_flag",
};

let exports;

(async () => {
  let response = await fetch("./aD8SvhyVkb");
  let wasmBytes = await response.arrayBuffer();
  let wasmInstance = await WebAssembly.instantiate(wasmBytes);
  exports = wasmInstance.instance.exports;
})();

function onButtonPress() {
  let inputElement = document.getElementById("input").value;

  for (let i = 0; i < inputElement.length; i++) {
    exports[functions.copyChar](inputElement.charCodeAt(i), i);
  }

  exports[functions.copyChar](0x0, inputElement.length);

  if (exports[functions.checkFlag]() === 0x1) {
    document.getElementById("result").innerHTML = "Correct!";
  } else {
    document.getElementById("result").innerHTML = "Incorrect!";
  }
}
